<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>The Breslauers - Rockabilly Band | Wrocław, Poland</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="The Breslauers - Wrocław's premier rockabilly band. Latest news, shows, videos, and merch. Book us for your next event!">
  <meta property="og:site_name" content="The Breslauers">
  <meta property="og:title" content="The Breslauers - Rockabilly Band | Wrocław, Poland">
  <meta property="og:description" content="The Breslauers - Wrocław's hottest retro rockabilly band. See latest news, shows, videos, and merch!">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://thebreslauers.com">
  <meta property="og:image" content="https://i.ibb.co/JFpG46vP/unnamed.jpg">
  <link rel="icon" href="https://i.ibb.co/VpwyjP27/logopsd-1-nobg.png" type="image/png">
  <link href="https://fonts.googleapis.com/css2?family=Lobster&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
  <style>
.shows-modal-content {
  background: #222;
  padding: 3rem 2vw 2.2rem 2vw;
  border-radius: 0;
  max-width: 100vw;
  width: 100vw;
  max-height: 100vh;
  height: 100vh;
  overflow-y: auto;
  box-shadow: none;
  position: relative;
  display: flex;
  flex-direction: column;
  align-items: center;
}
#shows-modal h2, #shows-modal-title {
  color: var(--red);
  font-family: 'Lobster', cursive;
  margin-top: 2.6rem;
  margin-bottom: 2.4rem;
  font-size: 3.3rem;
  text-align: center;
  letter-spacing: 2px;
}
.shows-back-btn {
  position: absolute;
  top: 4rem;
  right: 2rem;
  background: var(--red, #c60018);
  color: #fff;
  border: none;
  border-radius: 8px;
  padding: 0.7rem 1.8rem;
  font-size: .3rem;
  font-family: inherit;
  font-weight: bold;
  cursor: pointer;
  box-shadow: 0 2px 12px #0007;
  z-index: 10;
}
.shows-back-btn:hover {
  background: #fff;
  color: var(--red, #c60018);
}
#shows-modal {
  position: fixed !important;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: rgba(0,0,0,0.85); /* dark overlay */
  display: none;
  z-index: 9999;
  justify-content: center;
  align-items: center;
}
#shows-modal.show {
  display: flex !important; /* center the content */
}
    :root { --red: #c60018; --black: #181818; --white: #fff; --gray: #313131; --footer-bg: #171717; }
    html, body { background: var(--black); color: var(--white); font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 0; min-height: 100vh; }
    a { color: var(--red); text-decoration: none; }
    a:hover { color: #ff3d3d; }
    body { min-height: 100vh; display: flex; flex-direction: column; }
    main { flex: 1 0 auto; }
    /* HERO SECTION */
    .hero-section { background: var(--black); text-align: center; padding: 0 0 2vw 0;}
    .hero-slideshow-wrapper { position: relative; max-width: 1600px; margin: 0 auto;}
    .hero-img { width: 100%; max-width: 1600px; min-height: 420px; border-radius: 0; box-shadow: 0 4px 24px #000c; object-fit: cover; background: #000; display: block; image-rendering: auto;}
    .hero-slideshow-arrows { position: absolute; top: 45%; left: 0; width: 100%; display: flex; justify-content: space-between; pointer-events: none;}
    .hero-arrow-btn { background: rgba(24,24,24,0.8); color: #fff; border: none; font-size: 2.5rem; border-radius: 50%; width: 56px; height: 56px; cursor: pointer; pointer-events: all;}
    /* NEWS SECTION */
    .news-section { background: var(--black); padding: 3.2rem 0 3.5rem 0; min-height: 410px; border-bottom: 2px solid var(--red);}
    .news-title-headline { font-family: 'Lobster', cursive; font-size: 3.3rem; color: var(--red); text-align: left; margin-bottom: 0.2em; letter-spacing: 2px;}
    .news-divider { height: 3px; background: var(--red); margin: 1.3rem 0 2rem 0; border-radius: 2px;}
    .news-flexrow { display: flex; flex-wrap: wrap; gap: 2.5rem; justify-content: flex-start;}
    .news-card {
  background: #181818;
  border-radius: 0;        /* Makes card corners square */
  box-shadow: 0 2px 18px #0009;
  display: flex;
  flex-direction: column;
  min-width: 280px;
  margin-bottom: 2.3rem;
  overflow: hidden;
  border: none;            /* Removes all borders */
  width: 320px;
}
    .news-card-img {
  width: 100%;
  aspect-ratio: 16/9;
  background: #111;
  object-fit: cover;
  border-radius: 0;        
  border: none;            
}
    .news-card-content { padding: 1.1rem 1.4rem 1.5rem 1.4rem; display: flex; flex-direction: column; flex: 1; justify-content: flex-start;}
    .news-card-title { font-family: 'Montserrat', Arial, Helvetica, sans-serif; color: var(--red); font-size: 1.45rem; font-weight: 700; margin-top: 0; margin-bottom: 0.5em;}
    .news-card-date { color: #fff; font-size: 1.07rem; margin-bottom: 0.7em; text-decoration: underline; letter-spacing: 1px;}
    .news-card-body { color: #fff; font-size: 1.10rem; margin-bottom: 0.8em; min-height: 48px;}
    .news-admin-btn { background: none; border: 2px solid var(--red); color: var(--red); border-radius: 8px; padding: 0.5em 1.2em; font-size: 1.1em; font-weight: bold; cursor: pointer; margin-left: 0.5em; margin-bottom: 0.5em; transition: background .16s, color .16s;}
    .news-admin-btn:hover { background: var(--red); color: #fff;}
    /* SHOWS SECTION */
    .shows-section { background: var(--black); padding: 3.2rem 0 3.5rem 0; min-height: 340px; border-bottom: 2px solid var(--red);}
    .show-borderbox { background: var(--gray); margin: 0 2vw; padding: 2.8rem 2rem 3.2rem 2rem; border: 5px solid var(--red); border-radius: 12px; max-width: 850px; margin-left: auto; margin-right: auto; box-shadow: 0 4px 32px #000b; color: var(--white);}
    .show-title { font-family: 'Lobster', cursive; font-size: 2.8rem; color: var(--red); text-align: center; margin-bottom: 1.3rem; letter-spacing: 2px;}
    .show-flexrow { display: flex; justify-content: flex-start; align-items: flex-start; gap: 3vw; margin-bottom: 1.1rem; flex-wrap: wrap;}
    .show-col { text-align: left; }
    .show-date .show-label { font-weight: 700; font-size: 1.6rem; margin-bottom: .2em; color: var(--red);}
    .show-venue .show-label { font-size: 1.2rem; margin-bottom: .2em; color: var(--red);}
    .show-venue .show-city { font-size: 1.15rem; color: #fff;}
    .show-ticketbtn { background: var(--red); border: 2px solid var(--white); color: #fff; font-weight: 700; font-size: 1.12rem; padding: 0.7em 2.5em; border-radius: 7px; margin-top: 0.8em; cursor: pointer; box-shadow: 0 2px 12px #0007; letter-spacing: 1px; transition: background .15s, color .15s;}
    .show-subtitle { color: #fff; font-size: 1.2rem; margin-top: 0.6rem; text-align: left; font-weight: 500;}
    .show-tourbtn { display: block; margin: 2.5em 0 0 0; background: var(--red); color: #fff; font-weight: bold; border: 4px solid var(--red); border-radius: 8px; padding: 1em 2.2em; font-size: 1.25em; text-align: left; text-decoration: none; letter-spacing: 2px; transition: background 0.18s, color 0.18s; box-shadow: 0 2px 16px #0008; max-width: fit-content;}
    /* VIDEOS SECTION */
    .videos-section { background: var(--black); padding: 3.2rem 0 3.5rem 0; min-height: 320px; border-bottom: 2px solid var(--red);}
    .video-container { width: 100%; max-width: 950px; margin: 0 auto; padding: 0 1.2rem; box-sizing: border-box;}
    .video-title-headline { font-family: 'Lobster', cursive; font-size: 3.2rem; color: var(--red); text-align: left; margin-bottom: 0.2em; letter-spacing: 2px;}
    .video-mainframe { margin: 0 auto 1.5rem auto; width: 100%; max-width: 650px; background: #222; border-radius: 10px; overflow: hidden; box-shadow: 0 2px 22px #000c;}
    .video-mainframe iframe, .video-mainframe img { width: 100%; height: 320px; display: block; border: none; background: #000;}
    .video-morelink { font-family: 'Montserrat', Arial, Helvetica, sans-serif; font-weight: 700; font-size: 1.15rem; color: var(--red); text-decoration: underline; margin-left: 0.8rem; margin-bottom: 1rem; display: inline-block; letter-spacing: 1px;}
    .video-morelink:hover { color: #fff; background: var(--red);}
    /* MERCH SECTION */
    .merch-section { background: var(--black); padding: 3.2rem 0 3.5rem 0; min-height: 320px; border-bottom: 2px solid var(--red);}
    .merch-grid { width: 100%; display: flex; flex-wrap: wrap; gap: 2.5%; justify-content: flex-start; margin-bottom: 1.2em;}
    .merch-img-top { width: 180px; aspect-ratio: 4/3; object-fit: cover; border-radius: 12px; background: #222; border: 2px solid var(--red); margin-bottom: 1.2em; min-width: 170px; box-shadow: 0 2px 14px #000a;}
    .merch-title { color: var(--red); font-family: 'Lobster', cursive; font-size: 2.7rem; margin-bottom: 1.4rem; letter-spacing: 2px;}
    .merch-captionbig { font-family: 'Montserrat', Arial, Helvetica, sans-serif; font-weight: 700; font-size: 2rem; color: var(--white); margin-top: 1.7em; margin-bottom: 1.5em; text-align: left; letter-spacing: 2px;}
    .merch-storebtn { background: var(--red); color: #fff; font-weight: bold; border: 3px solid var(--red); border-radius: 0.7em; padding: 0.8em 1.2em; font-size: 1.15em; letter-spacing: 1px; display: block; margin: 0; text-align: left; width: fit-content;}
    .merch-storebtn:hover { background: #fff; color: var(--red);}
    @media (max-width: 900px) { .merch-grid { flex-direction: column; gap: 1.5em;} .merch-img-top { width: 100%; } }
    /* FOOTER */
    footer { background: var(--footer-bg); min-height: 260px; border-top: 3px solid var(--red); margin-top: auto;}
    .footer-flex { display: flex; flex-wrap: wrap; gap: 2vw; max-width: 100vw; padding: 2em 3vw; }
    .footer-col { flex: 1 1 260px; min-width: 220px; display: flex; flex-direction: column; justify-content: flex-start; }
    .footer-band-title { font-family: 'Lobster', cursive; color: var(--red); font-size: 2.1rem; margin-bottom: 0.6em; }
    .footer-band-tagline { color: #fff; font-size: 1.1em; margin-bottom: 1em; }
    .footer-socials { margin-bottom: 1.1em; }
    .footer-socials a { color: #fff; font-size: 2.1em; margin-right: 1em; }
    .footer-socials a:hover { color: var(--red);}
    .footer-copy { color: #aaa; font-size: 1.07em; margin-top: 1.6em; }
    .footer-links { margin-top: 1.3em; }
    .footer-links a { color: #fff; margin-bottom: 1em; display: block; font-weight: bold; letter-spacing: 1.5px; font-size: 1.25em; }
    .footer-links a:hover { color: var(--red);}
    .footer-contact-card h3 { color: var(--red); font-family: 'Lobster', cursive; font-size: 1.4em; margin:0 0 0.7em 0;}
    .footer-contact-form input, .footer-contact-form textarea { width: 100%; margin-bottom: 0.7em; border-radius: 8px; border: 1px solid #444; padding: 0.7em 1em; background: #212121; color: #fff; font-size: 1.13rem;}
    .footer-contact-form button { background: var(--red); color: #fff; border: none; border-radius: 10px; padding: 0.8em 2em; font-size: 1.22rem; font-weight: bold; letter-spacing: 1px; cursor: pointer; margin-top: .2em;}
    .footer-contact-success { color: #fff; background: var(--red); padding: 0.6em 1em; margin-top: 1em; border-radius: 6px; }
    .footer-col:nth-child(2) { align-items: flex-start; }
    .footer-col:last-child { align-items: flex-end; }
    @media (max-width: 1100px) {
      .footer-flex { flex-direction: column; align-items:flex-start;}
      .footer-col { align-items: flex-start !important; }
      .footer-col:last-child { align-items: flex-start !important; }
    }
    /* ADMIN COG & MODALS */
    .admin-cog-float { position:fixed;bottom:24px;right:24px;z-index:999;background:rgba(24,24,24,.92);border-radius:50%;padding:12px;box-shadow:0 2px 18px #000a;cursor:pointer;}
    #admin-modal, #shows-modal, #edit-modal {
      display:none; position:fixed;z-index:2000;top:0;left:0;width:100vw;height:100vh;background:rgba(24,24,24,0.97);align-items:center;justify-content:center;
    }
    #admin-modal.show, #shows-modal.show, #edit-modal.show { display: flex; }
    #admin-modal-content, #edit-modal-content {
      background:#171717;padding:2rem 2rem 1.5rem 2rem;border-radius:18px;max-width:700px;width:95vw;box-shadow:0 8px 48px #000;position:relative;
    }

.left-space {
  margin-left: 32px;
}
@media (max-width: 600px) {
  .left-space {
    margin-left: 12px;
  }
}
.merch-row {
  display: flex;
  gap: 16px;
  margin-bottom: 18px;
}
.merch-row-top {
  justify-content: flex-start;
}
.merch-thumb {
  border-radius: 8px;
  overflow: hidden;
  display: flex;
  flex-direction: column;
  align-items: stretch;
  justify-content: flex-end;
  position: relative;
}
.merch-thumb-small {
  flex: 1 1 0;
  min-width: 0;
  max-width: 33.3%;
}
.merch-thumb-small img {
  width: 100%;
  aspect-ratio: 4/3;
  object-fit: cover;
  display: block;
}
.merch-thumb-large {
  width: 100%;
}
.merch-thumb-large img {
  width: 100%;
  aspect-ratio: 16/9;
  object-fit: cover;
  display: block;
}
.merch-label {
  padding: 0.7em 0.3em;
  color: #222;
  font-weight: bold;
  font-size: 1.2em;
  text-align: center;
  background: transparent;
}
.merch-admin-btns {
  text-align: center;
  margin-bottom: 8px;
}
@media (max-width: 900px) {
  .merch-row { flex-direction: column; }
  .merch-thumb-small, .merch-thumb-large { max-width: 100%; }
}
#shows-close-x.shows-back-btn {
  top: 3rem !important;
  right: 2rem !important;
  font-size: 1.1rem !important;
  background: var(--red, #c60018) !important;
  color: #fff !important;
  border-radius: 8px !important;
  padding: 0.7rem 1.8rem !important;
  font-family: inherit !important;
  font-weight: bold !important;
  box-shadow: 0 2px 12px #0007 !important;
}
  </style>
</head>
<body>
<main>
  <!-- HERO -->
  <section class="hero-section">
    <div class="hero-slideshow-wrapper">
      <img class="hero-img" id="hero-img" src="https://i.ibb.co/JFpG46vP/unnamed.jpg" alt="Band Hero Image" />
      <div class="hero-slideshow-arrows">
        <button class="hero-arrow-btn" id="hero-prev-slide" aria-label="Previous Slide">&#8592;</button>
        <button class="hero-arrow-btn" id="hero-next-slide" aria-label="Next Slide">&#8594;</button>
      </div>
    </div>
  </section>
  <!-- NEWS -->
 <section class="news-section" id="news">
  <div class="left-space">
    <div class="news-title-headline">News</div>
    <div class="news-divider"></div>
    <div class="news-flexrow" id="news-cards"></div>
  </div>
</section>
  <!-- SHOWS -->
  <section class="shows-section" id="shows">
    <div class="show-borderbox">
      <div class="show-title">Next Show</div>
      <div class="show-flexrow" id="shows-content"></div>
      <div class="show-subtitle" id="next-show-details"></div>
      <a class="show-tourbtn" href="#" id="see-all-shows-link">VIEW ALL SHOWS</a>
    </div>
  </section>
  <!-- VIDEOS -->
  <section class="videos-section" id="videos">
    <div class="video-container">
      <div class="video-title-headline">Latest Video</div>
      <div class="video-mainframe" id="videos-list"></div>
      <a href="https://www.youtube.com/channel/UC63oTY8eitEjXQmFRjox-Tw" class="video-morelink" target="_blank">MORE VIDEOS ➔</a>
    </div>
  </section>
  <!-- MERCH -->
 <section class="merch-section" id="merch">
  <div class="left-space">
    <div class="merch-title">Merch</div>
    <div class="merch-grid" id="merch-gallery"></div>
    <div class="merch-captionbig">check out our Bandcamp</div>
    <a class="bandcamp-link-btn merch-storebtn" href="https://thebreslauers.bandcamp.com/merch" target="_blank">click here</a>
  </div>
</section>
</main>
  <!-- FOOTER -->
  <footer>
    <div class="footer-flex">
      <div class="footer-col">
        <div class="footer-band-title">THE BRESLAUERS</div>
        <div class="footer-band-tagline">Rockabilly since 2020 • Wrocław</div>
        <div class="footer-socials">
          <a href="https://www.facebook.com/TheBreslauers/" target="_blank" aria-label="Facebook"><i class="fab fa-facebook"></i></a>
          <a href="https://www.instagram.com/the_breslauers/" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
          <a href="https://open.spotify.com/artist/0UXdYQbmxW65DYw2nrvm5l" target="_blank" aria-label="Spotify"><i class="fab fa-spotify"></i></a>
        </div>
        <div class="footer-copy">
          &copy; 2025 The Breslauers. All rights reserved.
        </div>
      </div>
      <div class="footer-col">
        <div class="footer-links">
          <a href="#news">NEWS</a>
          <a href="#shows">SHOWS</a>
          <a href="#merch">MERCH</a>
          <a href="#videos">VIDEOS</a>
        </div>
      </div>
      <div class="footer-col" style="max-width:410px;">
        <div class="footer-contact-card" id="contact">
          <h3>Contact Us</h3>
          <form class="footer-contact-form" id="footer-contact-form" action="https://formsubmit.co/breslauerstheband@gmail.com" method="POST">
            <input type="text" name="name" placeholder="Your Name" required maxlength="50">
            <input type="email" name="email" placeholder="Your Email" required maxlength="80">
            <textarea name="message" placeholder="Your Message" required rows="3" maxlength="500"></textarea>
            <input type="hidden" name="_captcha" value="false">
            <input type="hidden" name="_subject" value="New Contact From The Breslauers Website!">
            <button type="submit">Send</button>
            <div class="footer-contact-success" id="footer-contact-success" style="display:none;">Thank you! We'll get back to you soon.</div>
          </form>
        </div>
      </div>
    </div>
  </footer>
  <!-- ADMIN COG + MODALS -->
  <div class="admin-cog-float" id="admin-cog-float" title="Admin Panel">
    <i class="fas fa-cog"></i>
  </div>
  <div id="admin-modal">
    <div id="admin-modal-content">
      <button id="admin-close-x">&times;</button>
      <div id="admin-login">
        <h2 style="font-family:'Lobster',cursive;color:var(--red);margin-top:0;">Admin Login</h2>
        <input type="password" id="admin-password" placeholder="Admin Password" style="width:100%;margin-bottom:1em;padding:0.7em 1em;border-radius:8px;border:2px solid var(--gray);background:#222;color:#fff;font-size:1.13rem;">
        <button id="admin-login-btn" style="width:100%;background:var(--red);color:#fff;border:none;border-radius:8px;padding:0.8em 0;font-size:1.15rem;font-weight:bold;letter-spacing:1px;cursor:pointer;">Login</button>
        <div id="admin-login-error" style="color:#fff;background:var(--red);padding:0.5em 1em;margin-top:1em;border-radius:6px;display:none;">Wrong password. Try again.</div>
      </div>
      <div id="admin-panel" style="display:none;">
        <div id="admin-tabs" style="display:flex;gap:1em;margin-bottom:1em;">
          <button class="admin-tab-btn" onclick="selectAdminTab('hero')">Hero</button>
          <button class="admin-tab-btn" onclick="selectAdminTab('shows')">Shows</button>
          <button class="admin-tab-btn" onclick="selectAdminTab('news')">News</button>
          <button class="admin-tab-btn" onclick="selectAdminTab('videos')">Videos</button>
          <button class="admin-tab-btn" onclick="selectAdminTab('merch')">Merch</button>
        </div>
        <div id="admin-content"></div>
      </div>
    </div>
  </div>
  <div id="shows-modal" style="display:none;">
  <div class="shows-modal-content">
    <button id="shows-close-x" class="shows-back-btn">Back to Page</button>
    <h2 id="shows-modal-title">All Shows</h2>
    <ul id="modal-shows-list" style="list-style:none;padding:0;margin:0;"></ul>
  </div>
</div>
  <div id="edit-modal">
    <div id="edit-modal-content"></div>
  </div>
  <script type="module">

// FIREBASE BACKEND & ADMIN CRUD LOGIC

import { initializeApp } from "https://www.gstatic.com/firebasejs/11.10.0/firebase-app.js";
import {
  getFirestore, doc, setDoc, getDoc, getDocs,
  collection, addDoc, deleteDoc, updateDoc, query, orderBy
} from "https://www.gstatic.com/firebasejs/11.10.0/firebase-firestore.js";

// --- FIREBASE CONFIG (replace with your own if needed) ---
const firebaseConfig = {
  apiKey: "AIzaSyDe-Q7cT33bwzbqMYu0p-2pQsSMnmwIcy0",
  authDomain: "thebreslauers-2437f.firebaseapp.com",
  projectId: "thebreslauers-2437f",
  storageBucket: "thebreslauers-2437f",
  messagingSenderId: "138453164929",
  appId: "1:138453164929:web:a57dcc256bf67356dabe80"
};
const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// --- STATE ---
let state = {
  hero: {
    images: [
      { url: 'https://i.ibb.co/JFpG46vP/unnamed.jpg', href: '' },
      { url: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=800&q=80', href: '' }
    ]
  },
  merch: [],
  news: [],
  videos: [],
  shows: []
};
let adminLoggedIn = false, heroSlideIdx = 0, heroSlideTimer, adminTab = 'hero';

// --- HERO SLIDESHOW ---
function renderHeroSlideshow() {
  let imgs = Array.isArray(state.hero.images) && state.hero.images.length
    ? state.hero.images
    : [
      { url: 'https://i.ibb.co/JFpG46vP/unnamed.jpg', href: '' },
      { url: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=800&q=80', href: '' }
    ];
  let imgObj = imgs[heroSlideIdx % imgs.length];
  let img = document.getElementById('hero-img');
  img.src = imgObj.url;
  img.onclick = () => { if(imgObj.href) window.open(imgObj.href, "_blank"); };
}
function nextHeroSlide() {
  let imgs = Array.isArray(state.hero.images) && state.hero.images.length
    ? state.hero.images
    : [
      { url: 'https://i.ibb.co/JFpG46vP/unnamed.jpg', href: '' },
      { url: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=800&q=80', href: '' }
    ];
  heroSlideIdx = (heroSlideIdx + 1) % imgs.length;
  renderHeroSlideshow();
  resetHeroSlideTimer();
}
function prevHeroSlide() {
  let imgs = Array.isArray(state.hero.images) && state.hero.images.length
    ? state.hero.images
    : [
      { url: 'https://i.ibb.co/JFpG46vP/unnamed.jpg', href: '' },
      { url: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=800&q=80', href: '' }
    ];
  heroSlideIdx = (heroSlideIdx - 1 + imgs.length) % imgs.length;
  renderHeroSlideshow();
  resetHeroSlideTimer();
}
function resetHeroSlideTimer() {
  clearTimeout(heroSlideTimer);
  heroSlideTimer = setTimeout(nextHeroSlide, 5000);
}
document.getElementById('hero-next-slide').onclick = nextHeroSlide;
document.getElementById('hero-prev-slide').onclick = prevHeroSlide;

// --- LOAD DATA ---
async function loadAllSections() {
  // HERO
  const heroSnap = await getDoc(doc(db, "site", "hero"));
  if (heroSnap.exists() && Array.isArray(heroSnap.data().images) && heroSnap.data().images.length)
    state.hero = heroSnap.data();
  // NEWS
  state.news = [];
  const newsSnap = await getDocs(query(collection(db, "news"), orderBy("date", "desc")));
  newsSnap.forEach(d => state.news.push({ ...d.data(), _id: d.id }));
  // SHOWS
  state.shows = [];
  const showsSnap = await getDocs(query(collection(db, "shows"), orderBy("date", "desc")));
  showsSnap.forEach(d => state.shows.push({ ...d.data(), _id: d.id }));
  // VIDEOS
  state.videos = [];
  const vSnap = await getDocs(query(collection(db, "videos"), orderBy("url", "desc")));
  vSnap.forEach(d => state.videos.push({ ...d.data(), _id: d.id }));
  // MERCH
  state.merch = [];
  const merchSnap = await getDocs(collection(db, "merch"));
  merchSnap.forEach(d => state.merch.push({ ...d.data(), _id: d.id }));
  renderAllSections();
}

function renderAllSections() {
  // HERO
  let imgs = Array.isArray(state.hero.images) && state.hero.images.length
    ? state.hero.images
    : [
      { url: 'https://i.ibb.co/JFpG46vP/unnamed.jpg', href: '' },
      { url: 'https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=800&q=80', href: '' }
    ];
  heroSlideIdx = 0;
  renderHeroSlideshow();
  resetHeroSlideTimer();

  // NEWS
  let newsGrid = document.getElementById('news-cards');
  newsGrid.innerHTML = '';
  let newsArr = state.news;
  newsArr.forEach((n, idx) => {
    newsGrid.innerHTML += `<div class="news-card">
      <img class="news-card-img" src="${n.img||'https://i.ibb.co/JFpG46vP/unnamed.jpg'}" alt="">
      <div class="news-card-content">
        <div class="news-card-title">${n.title||"(untitled)"}</div>
        <div class="news-card-date">${n.date||""}</div>
        <div class="news-card-body">${n.body||""}</div>
        ${n.link ? `<a class="news-card-link" href="${n.link}" target="_blank">Read More</a>` : ""}
        ${adminLoggedIn && n._id ? `<div><button class="news-admin-btn" onclick="editNews('${n._id}')">Edit</button>
        <button class="news-admin-btn" onclick="deleteNews('${n._id}')">Delete</button></div>` : ""}
      </div>
    </div>`;
  });
  if (adminLoggedIn) {
    newsGrid.innerHTML += `<div style="width:100%;margin-top:2em;text-align:right;">
      <button class="news-admin-btn" onclick="addNews()">+ Add News</button>
    </div>`;
  }

  // SHOWS
  let showsGrid = document.getElementById('shows-content');
  showsGrid.innerHTML = '';
 let showsArr = state.shows;
  let s = showsArr[0];
  showsGrid.innerHTML = `
    <div class="show-col show-date">
      <div class="show-label">${s.date||""}</div>
    </div>
    <div class="show-col show-venue">
      <div class="show-label">${s.venue||""}</div>
      <div class="show-label show-city">${s.city||""}</div>
    </div>
    <div class="show-col show-ticket">
      <button class="show-ticketbtn">${s.tix ? s.tix : "FREE"}</button>
      ${adminLoggedIn && s._id ? `<div style="margin-top:1em;">
        <button class="news-admin-btn" onclick="editShow('${s._id}')">Edit</button>
        <button class="news-admin-btn" onclick="deleteShow('${s._id}')">Delete</button>
        <button class="news-admin-btn" onclick="addShow()">+ Add Show</button>
      </div>`:""}
    </div>
  `;
  document.getElementById('next-show-details').textContent = s.details || "";
  if (adminLoggedIn && !s._id) {
    showsGrid.innerHTML += `<div style="width:100%;margin-top:2em;text-align:right;">
      <button class="news-admin-btn" onclick="addShow()">+ Add Show</button>
    </div>`;
  }

  // VIDEOS

 // VIDEOS
let videosList = document.getElementById('videos-list');
videosList.innerHTML = '';
let vids = state.videos;
let v = vids[0];
if (v && v.url && v.url.includes('youtube.com')) {
  videosList.innerHTML = `<iframe src="${v.url}" frameborder="0" allowfullscreen></iframe>
    ${adminLoggedIn && v._id ? `<div style="margin-top:1em;text-align:right;">
      <button class="news-admin-btn" onclick="editVideo('${v._id}')">Edit</button>
      <button class="news-admin-btn" onclick="deleteVideo('${v._id}')">Delete</button>
      <button class="news-admin-btn" onclick="addVideo()">+ Add Video</button>
    </div>` : ""}
  `;
} else if (adminLoggedIn) {
  videosList.innerHTML = `<div style="width:100%;margin-top:2em;text-align:right;">
    <button class="news-admin-btn" onclick="addVideo()">+ Add Video</button>
  </div>`;
} else {
  videosList.innerHTML = '';
}

  // MERCH
  let merchGallery = document.getElementById('merch-gallery');
merchGallery.innerHTML = '';
let merchArr = state.merch;

// Top row: up to 3 thumbnails
merchGallery.innerHTML += '<div class="merch-row merch-row-top">';
for(let i=0; i<3 && i<merchArr.length; ++i){
  let m = merchArr[i];
  merchGallery.innerHTML += `
    <div class="merch-thumb merch-thumb-small">
      <img src="${m.img||'https://i.ibb.co/JFpG46vP/unnamed.jpg'}" alt="">
      <div class="merch-label">${m.name||""}</div>
      ${adminLoggedIn && m._id ? `<div class="merch-admin-btns">
        <button class="news-admin-btn" onclick="editMerch('${m._id}')">Edit</button>
        <button class="news-admin-btn" onclick="deleteMerch('${m._id}')">Delete</button>
      </div>`:""}
    </div>
  `;
}
merchGallery.innerHTML += '</div>';

// Bottom row: 4th thumbnail (if exists)
if(merchArr.length >= 4){
  let m = merchArr[3];
  merchGallery.innerHTML += `<div class="merch-row merch-row-large">
    <div class="merch-thumb merch-thumb-large">
      <img src="${m.img||'https://i.ibb.co/JFpG46vP/unnamed.jpg'}" alt="">
      <div class="merch-label">${m.name||""}</div>
      ${adminLoggedIn && m._id ? `<div class="merch-admin-btns">
        <button class="news-admin-btn" onclick="editMerch('${m._id}')">Edit</button>
        <button class="news-admin-btn" onclick="deleteMerch('${m._id}')">Delete</button>
      </div>`:""}
    </div>
  </div>`;
}
  if (adminLoggedIn) {
    merchGallery.innerHTML += `<div style="width:100%;margin-top:2em;text-align:right;">
      <button class="news-admin-btn" onclick="addMerch()">+ Add Merch</button>
    </div>`;
  }

  
 // SHOWS MODAL
let mslist = document.getElementById('modal-shows-list');
if(mslist){
  mslist.innerHTML = '';
  (state.shows.length?state.shows:[
    {title:"Live at Klub Stary Klasztor",date:"2025-07-12",city:"Wrocław",details:"Come party with us at our summer headline show!"},
    {title:"Summer Bash Festival",date:"2025-08-05",city:"Kraków",details:"We're on the main stage with The Rockets!"}
  ]).forEach(show => {
    mslist.innerHTML += `<li style="padding:0.7em 0;border-bottom:1px solid #2c2c2c;"><b>${show.title || ""}</b><br>
    <span style="color:#ffdbdb">${show.date || ""}</span> @ ${show.city || ""}<br>
    <span style="font-size:0.96em;color:#ccc">${show.details || ""}</span>
    </li>`;
  });
}

// MAKE SURE THE HANDLER IS ALWAYS ATTACHED AFTER RENDER
setTimeout(function() {
  var seeAllShowsLink = document.getElementById('see-all-shows-link');
  var showsModal = document.getElementById('shows-modal');
  if (seeAllShowsLink && showsModal) {
    seeAllShowsLink.onclick = function(e) {
      e.preventDefault();
      showsModal.classList.add('show');
    };
  }
}, 0); 
}

// Always re-attach the handler so the modal opens correctly
const seeAllShowsLink = document.getElementById('see-all-shows-link');
if (seeAllShowsLink) {
  seeAllShowsLink.onclick = function(e) {
    e.preventDefault();
    document.getElementById('shows-modal').classList.add('show');
  };
}
loadAllSections();

// --- ADMIN PANEL + CRUD

function adminLogin() {
  let pwd = document.getElementById('admin-password').value.trim();
  if (pwd === "Karissaisadiva123!") {
    adminLoggedIn = true;
    document.getElementById('admin-login').style.display = "none";
    document.getElementById('admin-panel').style.display = "block";
    renderAdminEdits();
    renderAllSections();
  } else {
    document.getElementById('admin-login-error').style.display = "block";
  }
}
window.selectAdminTab = function(tab) {
  adminTab = tab;
  renderAdminEdits();
};
function renderAdminEdits() {
  const c = document.getElementById('admin-content');
  if (adminTab === "hero") {
    c.innerHTML = `
      <h3>Hero Section</h3>
      <form id="hero-form">
        <label>Images (one per line, format: URL, HREF):<br>
          <textarea name="images" style="width:100%;height:80px" placeholder="https://img1.jpg, https://link1.com&#10;https://img2.jpg, https://link2.com"></textarea>
        </label><br>
        <button type="submit">Save</button>
      </form>
    `;
    let heroImagesText = (state.hero.images || [])
      .map(img => img.url ? `${img.url}, ${img.href || ""}` : "").join('\n');
    document.querySelector('#hero-form textarea[name="images"]').value = heroImagesText;
    document.getElementById('hero-form').onsubmit = async function (e) {
      e.preventDefault();
      const fd = new FormData(this);
      const images = (fd.get("images") || "").split('\n').map(line => {
        let [url, href] = line.split(',').map(s => s.trim());
        return url ? { url, href } : null;
      }).filter(Boolean);
      const hero = { images };
      await setDoc(doc(db, "site", "hero"), hero);
      await loadAllSections();
      alert("Hero updated!");
    };
  }
  if (adminTab === "news") {
    c.innerHTML = `<button onclick="addNews()" style="margin-bottom:1em;">+ Add News</button>`;
    state.news.forEach(n => {
      c.innerHTML += `<div style="margin-bottom:0.7em;">
        <b>${n.title}</b> (${n.date})<br>
        <button onclick="editNews('${n._id}')">Edit</button>
        <button onclick="deleteNews('${n._id}')">Delete</button>
      </div>`;
    });
  }
  if (adminTab === "shows") {
    c.innerHTML = `<button onclick="addShow()" style="margin-bottom:1em;">+ Add Show</button>`;
    state.shows.forEach(s => {
      c.innerHTML += `<div style="margin-bottom:0.7em;">
        <b>${s.title}</b> (${s.date})<br>
        <button onclick="editShow('${s._id}')">Edit</button>
        <button onclick="deleteShow('${s._id}')">Delete</button>
      </div>`;
    });
  }
  if (adminTab === "videos") {
    c.innerHTML = `<button onclick="addVideo()" style="margin-bottom:1em;">+ Add Video</button>`;
    state.videos.forEach(v => {
      c.innerHTML += `<div style="margin-bottom:0.7em;">
        <b>${v.url}</b><br>
        <button onclick="editVideo('${v._id}')">Edit</button>
        <button onclick="deleteVideo('${v._id}')">Delete</button>
      </div>`;
    });
  }
  if (adminTab === "merch") {
    c.innerHTML = `<button onclick="addMerch()" style="margin-bottom:1em;">+ Add Merch</button>`;
    state.merch.forEach(m => {
      c.innerHTML += `<div style="margin-bottom:0.7em;">
        <b>${m.name}</b><br>
        <button onclick="editMerch('${m._id}')">Edit</button>
        <button onclick="deleteMerch('${m._id}')">Delete</button>
      </div>`;
    });
  }
}

// --- CRUD MODAL LOGIC ---
window.addNews = () => openEditModal("news", null, {});
window.editNews = (id) => { let n = state.news.find(x => x._id === id); openEditModal("news", id, n); };
window.deleteNews = async (id) => { if (!confirm("Are you sure?")) return; await deleteDoc(doc(db, "news", id)); await loadAllSections(); alert("News deleted!"); };
window.addShow = () => openEditModal("shows", null, {});
window.editShow = (id) => { let s = state.shows.find(x => x._id === id); openEditModal("shows", id, s); };
window.deleteShow = async (id) => { if (!confirm("Are you sure?")) return; await deleteDoc(doc(db, "shows", id)); await loadAllSections(); alert("Show deleted!"); };
window.addVideo = () => openEditModal("videos", null, {});
window.editVideo = (id) => { let v = state.videos.find(x => x._id === id); openEditModal("videos", id, v); };
window.deleteVideo = async (id) => { if (!confirm("Are you sure?")) return; await deleteDoc(doc(db, "videos", id)); await loadAllSections(); alert("Video deleted!"); };
window.addMerch = () => openEditModal("merch", null, {});
window.editMerch = (id) => { let m = state.merch.find(x => x._id === id); openEditModal("merch", id, m); };
window.deleteMerch = async (id) => { if (!confirm("Are you sure?")) return; await deleteDoc(doc(db, "merch", id)); await loadAllSections(); alert("Merch deleted!"); };

function openEditModal(section, id, val) {
  let html = "";
  if (section === "news") {
    html = `<h2 style="color:var(--red);font-family:'Lobster',cursive;">${id?"Edit":"Add"} News</h2>
      <form id="edit-news-form">
        <input type="text" name="title" value="${val?.title||""}" placeholder="Title" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="date" value="${val?.date||""}" placeholder="Date (YYYY-MM-DD)" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="img" value="${val?.img||""}" placeholder="Image URL" style="width:100%;margin-bottom:1em;">
        <textarea name="body" placeholder="Body" required style="width:100%;margin-bottom:1em;">${val?.body||""}</textarea>
        <input type="text" name="link" value="${val?.link||""}" placeholder="Read More Link (optional)" style="width:100%;margin-bottom:1em;">
        <button type="submit" style="width:100%;background:var(--red);color:#fff;border:none;border-radius:8px;padding:0.8em 0;font-size:1.15rem;font-weight:bold;letter-spacing:1px;cursor:pointer;">Save</button>
      </form>`;
  }
  if (section === "shows") {
    html = `<h2 style="color:var(--red);font-family:'Lobster',cursive;">${id?"Edit":"Add"} Show</h2>
      <form id="edit-shows-form">
        <input type="text" name="title" value="${val?.title||""}" placeholder="Title" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="date" value="${val?.date||""}" placeholder="Date (YYYY-MM-DD)" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="venue" value="${val?.venue||""}" placeholder="Venue" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="city" value="${val?.city||""}" placeholder="City" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="tix" value="${val?.tix||""}" placeholder="Tickets (FREE/$10/etc)" style="width:100%;margin-bottom:1em;">
        <input type="text" name="details" value="${val?.details||""}" placeholder="Details" style="width:100%;margin-bottom:1em;">
        <button type="submit" style="width:100%;background:var(--red);color:#fff;border:none;border-radius:8px;padding:0.8em 0;font-size:1.15rem;font-weight:bold;letter-spacing:1px;cursor:pointer;">Save</button>
      </form>`;
  }
  if (section === "videos") {
    html = `<h2 style="color:var(--red);font-family:'Lobster',cursive;">${id?"Edit":"Add"} Video</h2>
      <form id="edit-videos-form">
        <input type="text" name="url" value="${val?.url||""}" placeholder="YouTube Embed URL" required style="width:100%;margin-bottom:1em;">
        <button type="submit" style="width:100%;background:var(--red);color:#fff;border:none;border-radius:8px;padding:0.8em 0;font-size:1.15rem;font-weight:bold;letter-spacing:1px;cursor:pointer;">Save</button>
      </form>`;
  }
  if (section === "merch") {
    html = `<h2 style="color:var(--red);font-family:'Lobster',cursive;">${id?"Edit":"Add"} Merch</h2>
      <form id="edit-merch-form">
        <input type="text" name="name" value="${val?.name||""}" placeholder="Name" required style="width:100%;margin-bottom:1em;">
        <input type="text" name="img" value="${val?.img||""}" placeholder="Image URL" required style="width:100%;margin-bottom:1em;">
        <button type="submit" style="width:100%;background:var(--red);color:#fff;border:none;border-radius:8px;padding:0.8em 0;font-size:1.15rem;font-weight:bold;letter-spacing:1px;cursor:pointer;">Save</button>
      </form>`;
  }
  document.getElementById('edit-modal-content').innerHTML = html + `<button id="edit-close-x" style="position:absolute;top:1rem;right:1rem;background:none;border:none;font-size:2rem;color:#fff;cursor:pointer;">&times;</button>`;
  document.getElementById('edit-modal').classList.add('show');
  document.getElementById('edit-close-x').onclick = () => document.getElementById('edit-modal').classList.remove('show');
  if (section === "news") {
    document.getElementById('edit-news-form').onsubmit = async function(e) {
      e.preventDefault();
      const fd = new FormData(this);
      const obj = { title:fd.get("title"),date:fd.get("date"),img:fd.get("img"),body:fd.get("body"),link:fd.get("link") };
      if (id) await updateDoc(doc(db,"news",id),obj);
      else await addDoc(collection(db,"news"),obj);
      document.getElementById('edit-modal').classList.remove('show');
      await loadAllSections();
      alert("News saved!");
    };
  }
  if (section === "shows") {
    document.getElementById('edit-shows-form').onsubmit = async function(e) {
      e.preventDefault();
      const fd = new FormData(this);
      const obj = { title:fd.get("title"),date:fd.get("date"),venue:fd.get("venue"),city:fd.get("city"),tix:fd.get("tix"),details:fd.get("details") };
      if (id) await updateDoc(doc(db,"shows",id),obj);
      else await addDoc(collection(db,"shows"),obj);
      document.getElementById('edit-modal').classList.remove('show');
      await loadAllSections();
      alert("Show saved!");
    };
  }
  if (section === "videos") {
    document.getElementById('edit-videos-form').onsubmit = async function(e) {
      e.preventDefault();
      const fd = new FormData(this);
      const obj = { url:fd.get("url") };
      if (id) await updateDoc(doc(db,"videos",id),obj);
      else await addDoc(collection(db,"videos"),obj);
      document.getElementById('edit-modal').classList.remove('show');
      await loadAllSections();
      alert("Video saved!");
    };
  }
  if (section === "merch") {
    document.getElementById('edit-merch-form').onsubmit = async function(e) {
      e.preventDefault();
      const fd = new FormData(this);
      const obj = { name:fd.get("name"),img:fd.get("img") };
      if (id) await updateDoc(doc(db,"merch",id),obj);
      else await addDoc(collection(db,"merch"),obj);
      document.getElementById('edit-modal').classList.remove('show');
      await loadAllSections();
      alert("Merch saved!");
    };
  }
}

// SHOWS MODAL
document.getElementById('shows-close-x').onclick = function() {
  document.getElementById('shows-modal').classList.remove('show');
};

// CONTACT FORM FEEDBACK
document.getElementById('footer-contact-form').onsubmit = function(e){
  setTimeout(function(){
    document.getElementById('footer-contact-success').style.display="block";
    setTimeout(()=>{document.getElementById('footer-contact-success').style.display="none";},3200);
  }, 500);
};
</script>
<script>
  window.addEventListener('DOMContentLoaded', function() {
    var adminCog = document.getElementById('admin-cog-float');
    var adminModal = document.getElementById('admin-modal');
    var adminLogin = document.getElementById('admin-login');
    var adminPanel = document.getElementById('admin-panel');
    var adminClose = document.getElementById('admin-close-x');
    var adminLoginBtn = document.getElementById('admin-login-btn');
    if (!adminCog || !adminModal || !adminLogin || !adminPanel || !adminClose || !adminLoginBtn) {
      console.error('Admin modal elements not found in DOM');
      return;
    }

    adminCog.onclick = function() {
      adminModal.classList.add('show');
      adminLogin.style.display = window.adminLoggedIn ? "none" : "block";
      adminPanel.style.display = window.adminLoggedIn ? "block" : "none";
      if(window.adminLoggedIn && typeof renderAdminEdits === "function") renderAdminEdits();
    };
    adminClose.onclick = function() {
      adminModal.classList.remove('show');
    };
    adminLoginBtn.onclick = function() {
      var pwd = document.getElementById('admin-password').value.trim();
      if (pwd === "Karissaisadiva123!") {
        window.adminLoggedIn = true;
        adminLogin.style.display = "none";
        adminPanel.style.display = "block";
        if (typeof renderAdminEdits === "function") renderAdminEdits();
        if (typeof renderAllSections === "function") renderAllSections();
      } else {
        document.getElementById('admin-login-error').style.display = "block";
      }
    };
  });
// Make all admin functions global for HTML onclick
window.selectAdminTab = selectAdminTab;
window.addNews = addNews;
window.editNews = editNews;
window.deleteNews = deleteNews;
window.addShow = addShow;
window.editShow = editShow;
window.deleteShow = deleteShow;
window.addVideo = addVideo;
window.editVideo = editVideo;
window.deleteVideo = deleteVideo;
window.addMerch = addMerch;
window.editMerch = editMerch;
window.deleteMerch = deleteMerch;
</script>
</body>
</html>
